# Server模块
## 模块概述

Server模块是TinyServer的核心组件，负责处理网络连接、事件分发和客户端请求处理。该模块采用Epoll边缘触发的I/O多路复用技术，结合线程池实现高并发处理。

## 功能特点

1. **高性能网络IO**
   - 使用Epoll边缘触发模式
   - 非阻塞IO操作
   - 支持大并发连接处理

2. **事件驱动架构**
   - 基于事件循环的处理模型
   - 高效的事件分发机制
   - 支持定时器事件处理

3. **连接管理**
   - 智能的连接池管理
   - 自动处理连接超时
   - 支持优雅关闭连接

## 模块架构

### Server类

`Server`类是该模块的核心类，主要负责以下功能：

1. **服务器初始化**
   - 初始化监听socket
   - 配置Epoll实例
   - 设置线程池参数

2. **事件循环**
   - 处理新连接请求
   - 分发IO事件
   - 管理定时器事件

3. **客户端处理**
   - HTTP请求解析
   - 路由分发
   - 响应生成

## 核心接口

```cpp
// 初始化服务器
void Init(int port, const std::string &root_dir);

// 启动服务器
void Start();

// 关闭服务器
void Stop();

// 处理客户端连接
void DealWithClient();

// 事件循环
void EventLoop();
```

## 配置说明

服务器主要配置参数包括：

- 端口号：服务器监听的端口
- 根目录：静态资源文件的根目录
- 线程池大小：处理请求的工作线程数量
- 最大连接数：服务器支持的最大并发连接数
- 超时时间：连接的最大空闲时间

## 使用示例

```cpp
// 创建服务器实例
Server server;

// 初始化服务器
server.Init(8080, "/path/to/root");

// 启动服务器
server.Start();
```

## 性能优化

1. **内存管理**
   - 使用内存池减少内存分配开销
   - 避免频繁的内存申请和释放

2. **并发处理**
   - 合理设置线程池大小
   - 使用线程安全的数据结构

3. **IO优化**
   - 使用零拷贝技术
   - 实现数据缓冲区

## 注意事项

1. 服务器启动前需要确保配置参数的正确性
2. 建议在生产环境中适当调整连接超时时间
3. 需要定期检查并处理僵尸进程
4. 建议开启日志记录以便问题排查